<section id="health">
    <div class="header" title="{{data.attributes.hp.breakdown}}">
        <div class="label">
            <h4> {{ localize 'PF2E.HitPointsShortLabel' }}</h4>
        </div>
        <div class="health-value">
            <input type="number" name="data.attributes.hp.value" value="{{ data.attributes.hp.value }}" data-dtype="Number" placeholder="0"/>
            <span>/</span>
            <input class="{{#if (lt data.attributes.hp.max 10)}}lt10{{else if (lt data.attributes.hp.max 100)}}lt100{{else}}lt1000{{/if}}" type="number" name="data.attributes.hp.max" value="{{ data.attributes.hp.max }}" data-dtype="Number" placeholder="0"/>
        </div>
        <div id="hp-temp" class="labelled-field">
            <div class="label">
                <h4>{{ localize 'PF2E.RuleElement.TempHPShortLabel' }}</h4>
            </div>
            <input id="hp-temp-value" type="number" name="data.attributes.hp.temp" value="{{ data.attributes.hp.temp }}" data-dtype="Number" placeholder="0"/>
        </div>
    </div>

    <div class="content">
        <input id="hp-details" type="text" name="data.attributes.hp.details" value="{{ data.attributes.hp.details }}" title="{{ data.attributes.hp.details }}" data-dtype="String" placeholder="{{ localize 'PF2E.NPC.HPExtraInfoLabelPlaceholder' }}"/>
    </div>
</section>


<section id="armor" >

    <div class="header" title="{{data.attributes.ac.breakdown}}">
        <div class="label armor-label">
            <h4> {{ localize 'PF2E.ArmorClassShortLabel' }}</h4>
        </div>
        <span class="armor-value">{{data.attributes.ac.value}}</span>

        <div id="armor-base" class="labelled-field">
            <div class="label">
                <h4>{{ localize 'PF2E.NPC.ArmorBaseLabel' }}</h4>
            </div>
            <input class="armor-value" type="number" name="data.attributes.ac.base" style="font-weight: normal;" value="{{ data.attributes.ac.base }}" data-dtype="Number" placeholder="0"/>
        </div>
    </div>

    <div class="content">
        <input class="armor-details" type="text" name="data.attributes.ac.details" value="{{ data.attributes.ac.details }}" data-dtype="String" placeholder="{{ localize 'PF2E.NPC.ArmorExtraInfoLabelPlaceholder' }}"/>
    </div>
</section>

{{#if hasShield}}
<section id="shield" class="section shield-section{{#if data.attributes.shieldBroken}} broken" title="{{localize 'PF2E.ShieldBTLabel'}}{{/if}}">
    <div class="header">
        <div class="label shield-label">
            <i class="fas fa-user-shield{{#if data.attributes.shieldBroken}} broken{{/if}}"></i>
            <h4> {{ localize 'PF2E.ShieldLabel' }}</h4>
            <div class="shield-value">
                <input id="shield-current" type="number" name="data.attributes.shield.value" value="{{ data.attributes.shield.value }}" title="{{localize "PF2E.ShieldCurrentTitle"}}" data-dtype="Number" placeholder="0"/>
                <span>/</span>
                <label id="shield-max" title="{{localize "PF2E.ShieldMaxTitle"}}">{{ data.attributes.shield.max }}</label>
            </div>
        </div>
    </div>
    <div class="content">
        <div class="shield-details">
            <label class="label" title="{{ localize 'PF2E.ShieldACBonusTitle' }}">{{ localize 'PF2E.ArmorClassShortLabel' }}</label>
            <label class="value">{{ data.attributes.shield.ac }}</label>
            <label class="label" title="{{ localize 'PF2E.ShieldHardnessTitle' }}">{{ localize 'PF2E.ShieldHardnessShortLabel' }}</label>
            <label class="value">{{ data.attributes.shield.hardness }}</label>
            <label class="label" title="{{ localize 'PF2E.ShieldBTTitle' }}">{{ localize 'PF2E.ShieldBTShortLabel' }}</label>
            <label class="value">{{ data.attributes.shield.brokenThreshold }}</label>
        </div>
    </div>
</section>
{{/if}}



<!-- SENSES -->
<section id="senses" >
    <div class="header">
        <div class="label">
            <h4>{{ localize 'PF2E.NPC.SensesLabel' }}</h4>
        </div>

        <div id="perception" class="labelled-field" data-attribute="perception">
            <label class="attribute-label rollable"><a>{{ localize "PF2E.PerceptionLabel" }}</a></label>
            <input
                class="modifier{{#if (gte data.attributes.perception.value 0)}} not-negative{{/if}}{{#if (gt data.attributes.perception.totalModifier data.attributes.perception.base)}} positive-modifier{{/if}}{{#if (lt data.attributes.perception.totalModifier data.attributes.perception.base)}} negative-modifier{{/if}}"
                type="number"
                name="data.attributes.perception.value"
                value="{{ data.attributes.perception.value }}"
                data-base-property="data.attributes.perception.base"
                data-display-value="{{ data.attributes.perception.value }}"
                data-dtype="Number"
                placeholder="0"
            />
            <span class="plus{{#if (lt data.attributes.perception.value 10)}} lt10{{/if}}"></span>
        </div>
    </div>
    <div class="content">

        {{# if options.editable }}
        <input
            name="data.traits.senses.value"
            type="text"
            value="{{ data.traits.senses.value }}"
            title="{{ data.traits.senses.value }}"
            data-dtype="String"
            placeholder="Special Senses"
        />
        {{else}}
        <span>{{ data.traits.senses.value }}</span>
        {{/if}}
    </div>
</section>

<section id="saves" >
    <div class="header">
        <div class="label">
            <h4>{{ localize 'PF2E.NPC.SavesLabel' }}</h4>
        </div>
    </div>
    <div class="save-container">
        {{#each data.saves as |save saveId|}}
            <div class="save-item" data-save="{{saveId}}">
                <label class="attribute-label rollable" title="{{ save.breakdown }}"><a>{{ localize save.labelShort }}</a></label>
                <input class="modifier{{#if (gte save.value 0)}} not-negative{{/if}}{{#if (gt save.totalModifier save.base)}} positive-modifier{{/if}}{{#if (lt save.totalModifier save.base)}} negative-modifier{{/if}}" type="number" name="data.saves.{{saveId}}.value" value="{{save.value}}" data-display-value="{{save.value}}" data-base-property="data.saves.{{saveId}}.base" data-dtype="Number" placeholder="0"/>
                <span class="plus{{#if (lt save.value 10)}} lt10{{/if}}"></span>
            </div>
        {{/each}}
    </div>
    <div id="save-details" >
        <div class="content">
            <input type="text" name="data.attributes.allSaves.value" value="{{ data.attributes.allSaves.value }}" title="{{ data.attributes.allSaves.value }}" data-dtype="String" placeholder="{{ localize 'PF2E.NPC.SavesExtraInfoLabelPlaceholder' }}"/>
        </div>
    </div>
</section>

<section id="weaknesses" >
    <div class="header {{#unless data.traits.dv }} disabled {{/unless}}">
        <div class="label">
            <!-- <i class="fas fa-heart-broken"></i> -->
            <h4>{{ localize 'PF2E.WeaknessesLabel' }}</h4>
        </div>
        {{#if options.editable }}
        <div class="weaknesses-controls controls">
            <a class="trait-edit edit" data-trait-selector="weaknesses" title="{{ localize 'PF2E.NPC.EditWeaknesses' }}"><i class="fas {{#if data.traits.dv }}fa-edit {{else}}fa-plus{{/if}}"></i></a>
        </div>
        {{/if}}
    </div>
    <div class="content">
        {{#each data.traits.dv as |weakness key|}}
        <div class="weakness" data-weakness="{{weakness.type}}">{{ weakness.label }} {{ weakness.value }}</div>
        {{/each}}
    </div>
</section>

<section id="resistances" >
    <div class="header {{#unless data.traits.dr }} disabled {{/unless}}">
        <div class="label">
            <!-- <i class="fas fa-shield-virus"></i> -->
            <h4>{{ localize 'PF2E.ResistancesLabel' }}</h4>
        </div>
        {{#if options.editable }}
        <div class="resistances-controls controls">
            <a class="trait-edit edit" data-trait-selector="resistances" title="{{ localize 'PF2E.NPC.EditResistances' }}"><i class="fas {{#if data.traits.dr }}fa-edit {{else}}fa-plus{{/if}}"></i></a>
        </div>
        {{/if}}
    </div>
    <div class="content">
        {{#each data.traits.dr as |resistance key|}}
        <div class="resistance" data-weakness="{{resistance.type}}">{{ resistance.label }} {{ resistance.value }}{{#if resistance.exceptions}} ({{resistance.exceptions}}){{/if}}</div>
        {{/each}}
    </div>
</section>

<section id="immunities" >
    <div class="header{{#unless immunities}} disabled{{/unless}}">
        <div class="label">
            <!-- <i class="fas fa-ankh"></i> -->
            <h4>{{ localize 'PF2E.ImmunitiesLabel' }}</h4>
        </div>
        {{#if options.editable }}
        <div class="immunities-controls controls">
            <a class="trait-edit edit" data-trait-selector="basic" data-config-types="immunityTypes" data-property="data.traits.di" title="{{ localize 'PF2E.NPC.EditImmunities' }}"><i class="fas {{#if immunities}}fa-edit {{else}}fa-plus{{/if}}"></i></a>
        </div>
        {{/if}}
    </div>

    <div class="content">
        {{#each immunities as |immunity key|}}
            <div class="immunity" data-weakness="{{localize key}}">{{localize immunity}}</div>
        {{/each}}
    </div>
</section>


<section id="effects" class="section effects">
    <div class="header">
        <div class="label">
            <!-- <i class="fas fa-adjust"></i> -->
            <h4>{{localize "PF2E.EffectsLabel"}}</h4>
        </div>
    </div>
    <div class="content">
        <div class="effects-list inventory-list">
            {{#each conditions as |condition index|}}
                <div class="item item-name effect expandable" title="{{condition.name}}" data-item-id="{{condition._id}}" data-action-index="{{index}}">
                    <div class="item-image" style="background-image: url({{condition.img}})"></div>
                </div>
            {{/each}}
            {{#each effects as |effect|}}
                {{#if @first}}<div class="separator"></div>{{/if}}
                <div class="item effect expandable" title="{{effect.name}}" data-item-id="{{effect._id}}">
                    <div class="item-image" style="background-image: url({{effect.img}})"></div>
                </div>
            {{/each}}
        </div>
    </div>
</section>
