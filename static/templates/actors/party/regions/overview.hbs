<section class="content">
    {{#unless members}}
        <div class="blank-slate">
            {{localize "PF2E.Actor.Party.BlankSlate"}}
        </div>
    {{/unless}}

    {{#if members}}
        <div class="summary">
            <label>
                {{localize "PF2E.Actor.Party.Languages"}}
                <span class="total">{{localize "PF2E.Actor.Party.LanguagesKnown" total=languages.length}}</span>
            </label>
            <ul class="tags">
                {{#unless languages}}
                    {{localize "PF2E.NoneOption"}}
                {{/unless}}
                {{#each languages as |language|}}
                    <li class="tag tag_alt" data-language="{{language.slug}}">
                        {{language.label}}{{#if (gt language.actors.length 1)}} ({{language.actors.length}}){{/if}}
                    </li>
                {{/each}}
            </ul>
        </div>
    {{/if}}

    {{#each members as |member|}}
        <section class="member" data-actor-uuid="{{member.actor.uuid}}">
            <div class="portrait">
                <a data-action="open-sheet"><img src="{{member.actor.img}}" /></a>
                <span class="ac">
                    <div class="shield"></div>
                    <label>{{localize "PF2E.ArmorClassShortLabel"}}</label>
                    <span class="value">{{member.actor.attributes.ac.value}}</span>
                </span>
            </div>
            <div class="data">
                <div class="name">
                    <a data-action="open-sheet">{{member.actor.name}}</a>
                    {{#if @root.user.isGM}}
                        <a data-action="remove-member"><i class="fa-solid fa-fw fa-times"></i></a>
                    {{/if}}
                    {{#if member.heroPoints}}
                        <a class="hero-points" data-action="adjust-hero-points">
                            {{#times member.heroPoints.max}}
                                {{#if (gt member.heroPoints.value this)}}
                                    <img src="/systems/pf2e/dice/basic/heads.webp" />
                                {{else}}
                                    <span class="empty"></span>
                                {{/if}}
                            {{/times}}
                        </a>
                    {{/if}}
                </div>

                <div class="main-stats">
                    {{#with member.actor.attributes.hp as |hp|}}
                        <div class="score health">
                            <label>{{localize "PF2E.HitPointsHeader"}}</label>
                            <div class="health-value">
                                <i class="fas fa-heart"></i>
                                <span class="value">{{hp.value}}</span>
                                / <span class="max">{{hp.max}}</span>
                            </div>
                            <div class="bar" style="width: {{percentage hp.value hp.max}}%;"></div>
                        </div>
                    {{/with}}

                    <div class="saving-throws">
                        <span class="score">
                            <label>{{localize "PF2E.SavesFortitudeShort"}}</label>
                            {{numberFormat member.actor.saves.fortitude.mod sign=true}}
                        </span>
                        <span class="score">
                            <label>{{localize "PF2E.SavesReflexShort"}}</label>
                            {{numberFormat member.actor.saves.reflex.mod sign=true}}
                        </span>
                        <span class="score">
                            <label>{{localize "PF2E.SavesWillShort"}}</label>
                            {{numberFormat member.actor.saves.will.mod sign=true}}
                        </span>
                    </div>

                    <div class="score senses-speeds">
                        <label>
                            {{#if (eq member.actor.type "familiar")}}
                                <span class="abc">{{localize "PF2E.Familiar.Familiar"}}</span>
                                {{#if member.actor.master}}
                                    <span class="abc">{{member.actor.master.name}}</span>
                                {{/if}}
                            {{else if member.actor.system.details.creatureType}}
                                <span class="abc">{{member.actor.system.details.creatureType}}</span>
                            {{else}}
                                {{#if member.actor.ancestry}}
                                    <span class="abc">{{member.actor.ancestry.name}}</span>
                                {{/if}}
                                {{#if member.actor.class}}
                                    <span class="abc">{{member.actor.class.name}}</span>
                                {{/if}}
                            {{/if}}
                            <span class="size">{{localize member.size.label}}</span>
                        </label>
                        <div class="value">
                            {{#each member.speeds as |speed|}}
                                <span class="tag-light">{{localize speed.label}} {{speed.value}}</span>
                            {{/each}}
                            {{#each member.senses as |sense|}}
                                <span class="tag-light" data-acuity="{{sense.acuity}}" data-tooltip="{{sense.labelFull}}">{{localize sense.label}}</span>
                            {{/each}}
                        </div>
                    </div>
                </div>

                <div class="skills">
                    {{#with member.actor.perception as |perception|}}
                        <button type="button" class="perception tag-light rollable" {{#if perception.rank}}data-rank="{{perception.rank}}"{{/if}} {{#if @root.user.isGM}}data-action="roll" data-statistic="perception" data-secret="true"{{/if}}>
                            {{perception.label}} <span class="mod">{{numberFormat perception.mod sign=true}}</span>
                        </button>
                    {{/with}}
                    {{#each member.bestSkills as |skill|}}
                        <span class="tag-light" {{#if skill.rank}}data-rank="{{skill.rank}}"{{/if}}>
                            {{skill.label}} <span class="mod">{{numberFormat skill.mod sign=true}}</span>
                        </span>
                    {{/each}}
                </div>
            </div>
        </section>
    {{/each}}
</section>
